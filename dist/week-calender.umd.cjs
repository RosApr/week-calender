(function(p,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(p=typeof globalThis<"u"?globalThis:p||self,e(p.WeekCalender={},p.Vue))})(this,function(p,e){"use strict";const B=["星期一","星期二","星期三","星期四","星期五","星期六","星期日"],F=Array.from({length:24}).map((o,t)=>t),k=48,E="0".repeat(k*7),A=E.split("");function D(o){const t=o/2;return o%2===0?`${v(t)}:00 ~ ${v(t)}:30`:`${v(Math.floor(t))}:30 ~ ${v(Math.ceil(t))}:00`}function O(o){const t=Math.floor(o/k)+1,i=D(o%k);return`${B[t-1]} - ${i}`}function v(o){return o<10?`0${o}`:o}function V(o){const t=Math.floor(o/k);return{row:t,col:o-t*k}}const M={row:void 0,col:void 0},W=e.defineComponent({name:"WeekCalenderGrid",props:{id:{type:Number,required:!0},selected:{type:Array,default:[]}},emits:["mouseOver","mouseDown","mouseOut","mouseUp","click"],setup(o,{emit:t}){const i=e.computed(()=>o.selected.includes(o.id));function r(n,y){const m=n.target.getBoundingClientRect(),w={left:m.left-75+6+"px",top:m.top-window.screenTop-35-5+"px"};t("mouseOver",y,w)}function c(){t("mouseOut")}function f(n){t("mouseDown",n)}function a(n){t("mouseUp",n)}function l(n){t("click",n)}return{isActive:i,handleMouseout:c,handleMouseover:r,handleMousedown:f,handleMouseup:a,handleClick:l}}}),fe="",b=(o,t)=>{const i=o.__vccOpts||o;for(const[r,c]of t)i[r]=c;return i};function R(o,t,i,r,c,f){return e.openBlock(),e.createElementBlock("div",{onMousedown:t[0]||(t[0]=a=>o.handleMousedown(o.$props.id)),onMouseover:t[1]||(t[1]=a=>o.handleMouseover(a,o.$props.id)),onMouseout:t[2]||(t[2]=(...a)=>o.handleMouseout&&o.handleMouseout(...a)),onMouseup:t[3]||(t[3]=a=>o.handleMouseup(o.$props.id)),onClick:t[4]||(t[4]=a=>o.handleClick(o.$props.id)),class:e.normalizeClass(["time-grid",{active:o.isActive}])},null,34)}const G=b(W,[["render",R],["__scopeId","data-v-41ab9ecf"]]),C=e.defineComponent({name:"WeekCalender",props:{value:{type:String,default:""},disabled:{type:Boolean,default:!1}},emits:["update:value","change"],components:{weekCalenderGrid:G},setup(o,{emit:t}){const i=e.computed(()=>o.disabled??!1),r=e.computed(()=>{const s=[];return(o.value||"").split("").forEach((h,u)=>{h==="1"&&s.push(u)}),s}),c=e.ref(!1),f=e.ref([]),a=e.ref(!1),l=e.ref(M),n=e.ref(M),y=e.computed(()=>a.value?[...r.value,...f.value]:[...r.value.filter(s=>!f.value.includes(s))]),m=e.ref({left:"0px",top:"0px",show:!1,id:0}),w=e.ref(!1);function le(s){w.value=!0,c.value=!0,m.value.show=!1,a.value=!r.value.includes(s),l.value=V(s)}function se(s){c.value=!1;let d="";if(w.value&&typeof s=="number"){const h=r.value.indexOf(s);let u=[...r.value];h<0?u.push(s):u=u.filter(_=>_!==s),d=T(u)}else d=T(y.value),f.value=[],n.value=M,l.value=M;d!==o.value&&(t("update:value",d),t("change",d))}function ae(){m.value.show=!1}function re(s,d){if(w.value=!1,m.value={...d,show:!c.value,id:s},!c.value||n.value===s)return;n.value=V(s);const h=Math.abs(l.value.col-n.value.col)+1;let u=[],_=Math.min(l.value.row,n.value.row);const ie=Math.min(l.value.col,n.value.col),ce=Math.max(l.value.row,n.value.row);for(;_<=ce;){const ue=Array.from({length:h}).map((he,pe)=>_*k+ie+pe);u=[...u,...ue],_++}f.value=u}function de(){t("update:value",E),t("change",E)}function T(s){const d=Array(...A);return s.forEach(h=>{d[h]="1"}),d.join("")}return{disabled:i,handleMousedown:le,handleMouseup:se,handleMouseout:ae,handleMouseover:re,showTooltip:m,currentSelected:y,Time:F,Week:B,getFullWeekAndTime:O,handleReset:de}}}),N=()=>{e.useCssVars(o=>({d072781e:o.showTooltip.left,fe770faa:o.showTooltip.top}))},S=C.setup;C.setup=S?(o,t)=>(N(),S(o,t)):N;const me="",g=o=>(e.pushScopeId("data-v-415e5aa4"),o=o(),e.popScopeId(),o),P={class:"time-calender-container"},I={class:"time-calender"},j={class:"header-info"},L=g(()=>e.createElementVNode("div",{class:"text-center info-grid week-label"}," 星期\\时间 ",-1)),U={class:"info-grid-container",style:{width:"100%",background:"#f2f4f5"}},q=g(()=>e.createElementVNode("div",{class:"text-center info-grid time-info"}," 00:00 - 12:00 ",-1)),z=g(()=>e.createElementVNode("div",{class:"text-center info-grid time-info"}," 12:00 - 24:00 ",-1)),H={class:"time-label-container"},J={class:"time-container"},K={class:"week-label-container"},Q={class:"label"},X=g(()=>e.createElementVNode("div",{class:"arrow"},null,-1)),Y={class:"tip-container"},Z={class:"row middle between"},x=e.createStaticVNode('<div class="col" data-v-415e5aa4><div class="row middle" data-v-415e5aa4><div class="col" data-v-415e5aa4>已选择时间段:</div><div class="col" data-v-415e5aa4><span class="demo-time-grid active" data-v-415e5aa4></span> 选中 </div><div class="col" data-v-415e5aa4><span class="demo-time-grid" data-v-415e5aa4></span> 未选中 </div></div></div>',1),ee={class:"col"};function oe(o,t,i,r,c,f){const a=e.resolveComponent("weekCalenderGrid");return e.openBlock(),e.createElementBlock("div",P,[e.createElementVNode("div",I,[e.createElementVNode("div",j,[L,e.createElementVNode("div",U,[q,z,e.createElementVNode("div",H,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.Time,l=>(e.openBlock(),e.createElementBlock("div",{key:l,class:"time-label"},e.toDisplayString(l),1))),128))])])]),e.createElementVNode("div",J,[e.createElementVNode("div",K,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.Week,l=>(e.openBlock(),e.createElementBlock("div",{key:l,class:"text-center week-label info-grid"},e.toDisplayString(l),1))),128))]),e.createElementVNode("div",{class:"time-grid-container",onMouseleave:t[0]||(t[0]=l=>o.handleMouseup())},[o.disabled?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(Array.from({length:7*24*2}),(l,n)=>(e.openBlock(),e.createBlock(a,{id:n,key:n,selected:o.currentSelected},null,8,["id","selected"]))),128)):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(Array.from({length:7*24*2}),(l,n)=>(e.openBlock(),e.createBlock(a,{id:n,key:n,selected:o.currentSelected,onMouseOver:o.handleMouseover,onMouseOut:o.handleMouseout,onMouseDown:o.handleMousedown,onMouseUp:o.handleMouseup},null,8,["id","selected","onMouseOver","onMouseOut","onMouseDown","onMouseUp"]))),128)),e.createElementVNode("div",{class:"tooltip",style:e.normalizeStyle({display:o.showTooltip.show?"block":"none"})},[e.createElementVNode("div",Q,e.toDisplayString(o.getFullWeekAndTime(o.showTooltip.id)),1),X],4)],32)])]),e.createElementVNode("div",Y,[e.createElementVNode("div",Z,[x,e.createElementVNode("div",ee,[e.createElementVNode("a",{type:"link",onClick:t[1]||(t[1]=l=>o.handleReset())}," 清除全部 ")])])])])}const $=b(C,[["render",oe],["__scopeId","data-v-415e5aa4"]]),te={install(o){o.component($.name,$)}},ne={install(o){o.use(te)}};p.WeekCalender=$,p.WeekCalenderPlugin=ne,Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})});
